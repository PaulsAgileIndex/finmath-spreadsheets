<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>finMath.net: Spreadsheets</title>
		<link rel="stylesheet" type="text/css" href="../finmathnet-style.css"/>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<style type="text/css">
			.menu-item {
				font-size: 12pt;
				line-height: 16pt;
				font-face: plain; background: #eee; padding: 5px;
				font-style: normal;
				font-weight: bold;
				margin-top: 14pt;
				margin-left: 20px;
			}
		</style>
	</head>
	<body>
		<header>
			<span class="logo-white">finMath</span><span class="logo-red">.net</span>
		</header>

		<h1>Spreadsheets</h1>

		The spreadsheets are given in Excel (xls) and OpenOffice (ods) format and require the <i>Java Object Handler for Spreadsheets, <a href="http://www.obba.info">"Obba"</a></i>. Please check <a href="#requirements">requirements</a> below.

		<h2>Download</h2>
		
		You may retrieve the spreadsheets from the <tt><a href="https://github.com/finmath/finmath-spreadsheets">finmath spreadsheets</a></tt>.
		The ZIP files linked below can be found in the <tt><a href="https://github.com/finmath/finmath-spreadsheets/tree/master/docs/spreadsheets">spreadsheets</a></tt> folder.

<!--
		<h3>Random Number Generation</h3>
		
		<dl>
			<dt>
				<a href="spreadsheets/Pseudo Random and Low Discrepancy Sequences.zip">Pseudo Random and Low Discrepancy Sequences.zip</a>
			</dt>
			<dd>
				A collection of spreadsheets illustrating an aspects from random number generation: the generation of a higher dimensional sequence from a lower dimensional sequence.
			</dd>
		</dl>
-->
		
		<h3>Interest Rate Curves (Multi-Curve / OIS Discounting)</h3>

		<dl>
			<dt class="menu-item">
				<a href="spreadsheets/Curve%20Calibration.zip">Curve Calibration.zip</a>
			</dt>
			<dd>
				Calibration of curves
				(see package <a href="http://finmath.net/finmath-lib/apidocs/net.finmath.lib/net/finmath/marketdata/model/curves/package-summary.html"><tt>net.finmath.marketdata.model.curves</tt></a>).

				<p>
				The sheet calibrates a set of different curves (including discounting curves (e.g., OIS) and forward curves) from swaps. Swaps may feature different discounting curves (e.g., OIS discounting). Forward curves can be calibrated to standard swaps and tenor basis swaps. Discount curves may be calibrated to standard swaps or cross-currency basis swaps.
				</p>

				<p>
				Although the specific algorithm used is a calibration and not a classical bootstrap, this is sometimes called "curve bootstrapping".
				</p>
				
				<b>
				For details see the <a href="/topics/curvecalibration">curve calibration page</a>.
				</b>
			</dd>
		</dl>

		<h3>Forward Bond and Total Return Swap Valuation (bases on funding curves)</h3>

		<dl>
			<dt class="menu-item">
				<a href="spreadsheets/Forward%20Bond%20and%20Total%20Return%20Swap%20Valuation.zip">Forward Bond and Total Return Swap Valuation.zip</a>
			</dt>
			<dd>
				Valuation of Forward Bonds and Total Return Swaps.

				<p>
				The sheet calibrates a set of different curves (including discounting curves (e.g., OIS) and forward curves) from swaps. It also calibrates funding curves.
				
				It contains functionality for the valuation of forward bonds and total return swaps.
				</p>

				<p>
					<i>Valuation part contributed by Mark Lichtner. Based on the Curve Calibration Sheet.</i>
				</p>
				
				<b>
				For details see the <a href="/topics/forwardbondvaluation">forward bond valuation page</a>.
				</b>
			</dd>
		</dl>

		<h3>Monte-Carlo Simulation: Brownian Motion and Brownian Bridge</h3>
		
		<dl>

			<dt class="menu-item">
				<a href="spreadsheets/Brownian%20Motion.zip">Brownian Motion.zip</a>
			</dt>
			<dd>
				Generate an plot of some sample paths of a Brownian motion and a Brownian bridge.
			</dd>

		</dl>

		<h3>Black Scholes Model: Valuation</h3>

		<dl>
			<dt class="menu-item">
				<a href="spreadsheets/Density%20derived%20from%20Option%20Prices.zip">Density derived from Option Prices.zip</a>
			</dt>
			<dd>
				Calculation of the density of the underlying (under the risk neutral measure) by differentiation of option prices (numerically via finite differences).
			</dd>
		</dl>

		<dl>
			<dt class="menu-item">
				<a href="spreadsheets/Monte Carlo Valuation with Black Scholes Model - European - Asian - Bermudan.zip">Monte Carlo Valuation with Black Scholes Model - European - Asian - Bermudan.zip</a>
			</dt>
			<dd>
				Monte Carlo simulation of a Black-Scholes model. Contains several sheets related to valuation of options under the Black-Scholes model, e.g.,
				<ul>
					<li>valuation of European option,</li>
					<li>valuation of Asian option,</li>
					<li>valuation of Bermudan option</li>
				</ul>
				Also includes the valuation of a custom product where the payoff (valuation code) is embedded in the spreadsheet.
				<i>Note that this feature requires that Java runs from a JDK, not JRE (due to the requirement of on-the-fly compilation).</i>
			</dd>

			<dt class="menu-item">
				<a href="spreadsheets/Monte%20Carlo%20Simulation%20of%20Black%20Scholes%20Model%20for%20Custom%20Product.zip">Monte Carlo Simulation of Black Scholes Model for Custom Product.zip</a>
			</dt>
			<dd>
				Monte Carlo simulation of a Black-Scholes model and valuation of a given (customizable) payoff. The custom product is
				given in an external <tt>.java</tt>-file which has to be compiled to a <tt>.class</tt>-file manually.
			</dd>
		</dl>

		<h3>Black Scholes Model: Hedging</h3>

		<dl>
			<dt class="menu-item">
				<a href="spreadsheets/Monte%20Carlo%20Black%20Scholes%20Model%20Delta%20Hedge%20Portfolio.zip">Monte Carlo Black Scholes Model Delta Hedge Portfolio.zip</a>
			</dt>
			<dd>
				Monte Carlo simulation of a Black-Scholes delta hedged portfolio. Contains the Java source code of the hedge strategy (embedded in the spreadsheet).
				<i>Note that this feature requires that Java runs from a JDK, not JRE (due to the requirement of on-the-fly compilation).</i>
			</dd>
		</dl>

		<h3>Heston Model: Valuation</h3>

		<dl>
			<dt class="menu-item">
				<a href="spreadsheets/Monte%20Carlo%20Valuation%20with%20Heston%20Model.zip">Monte Carlo Valuation with Heston Model.zip</a>
			</dt>
			<dd>
				Monte Carlo simulation of a Heston model and the valuation of a European option.
				The sheet also plots the integrated variance of the Heston model as a function of the realized
				asset model, which give an intuitive understanding of the smile generated by the model.
				The sheet may be used as a starting point to study the Heston model properties.
			</dd>
		</dl>

		<h3>Merton Model: Valuation</h3>

		<dl>
			<dt class="menu-item">
				<a href="spreadsheets/Monte%20Carlo%20Valuation%20with%20Merton%20Model.zip">Monte Carlo Valuation with Merton Model.zip</a>
			</dt>
			<dd>
				Monte Carlo simulation of a Merton model and the valuation of a European option.
				The sheet may be used as a starting point to study the Merton model properties.
			</dd>
		</dl>

		<h3>Mean-Variance Hedging</h3>

		<dl>
			<dt class="menu-item">
				<a href="spreadsheets/Monte%20Carlo%20Model%20Risk%20Minimizing%20Hedge%20Portfolio.zip">Monte Carlo Model Risk Minimizing Hedge Portfolio.zip</a>
			</dt>
			<dd>
				A hedge simulation using a risk minimizing hedge ratio calculated via regression / American Monte-Carlo. The model used to generate the underlying paths is a Heston model, while the model used to calculate the Hedge ratios is a Black-Scholes model. The sheets thus allows to explore hedge errors introduced by model risk.
				<br/>
				You may adapt the sheet to use different combinations of simulation and valuation model.
			</dd>
		</dl>

		<h3>Interest Rate Swaps</h3>

		<dl>
			<dt class="menu-item">
				<a href="spreadsheets/Day%20Count%20Fractions.zip">Day Count Fractions.zip</a>
			</dt>
			<dd>
				Day Count Fractions
				(see package <a href="http://finmath.net/finmath-lib/apidocs/net.finmath.lib/net/finmath/time/daycount/package-summary.html"><tt>net.finmath.time.daycount</tt></a>).

				<p>
				The sheet tests several day count conventions against its native spreadsheet implementation using the YEARFRAC function.
				</p>

			</dd>

			<dt class="menu-item">
				<a href="spreadsheets/Swap%20Leg%20Schedule.zip">Swap Leg Schedule.zip</a>
			</dt>
			<dd>
				Swap Leg Schedule
				(see package <a href="http://finmath.net/finmath-lib/apidocs/net.finmath.lib/net/finmath/time/package-summary.html"><tt>net.finmath.time</tt></a>).

				<p>
					The generates a swap leg schedule, i.e., a sequence of periods with period start date, period end date, fixing date, payment date and period day count fractions, from given meta date, like spot, frequency, date roll convention, holiday calendars, day count convetions.
				</p>

			</dd>
		</dl>

		<h3>Interest Rate Derivatives</h3>

		<dl>
			<dt class="menu-item">
				<a href="spreadsheets/Swaption.zip">Swaption.zip</a>
			</dt>
			<dd>
				Valuation of swaption using the generalized Black-Scholes formula (Black model).
			</dd>

			<dt class="menu-item">
				<a href="spreadsheets/CMS%20Option.zip">CMS Option.zip</a>
			</dt>
			<dd>
				Valuation of cms option and a cms floor using the generalized Black-Scholes formula with a convexity adjustment.
			</dd>

			<dt class="menu-item">
				<a href="spreadsheets/Caplets.zip">Caplets.zip</a>
			</dt>
			<dd>
				Valuation of caps from a caplet volatility surface (lognormal or normal volatility).
			</dd>
		</dl>

		<h3>Interest Rate Derivatives: LIBOR Market Model</h3>

		<dl>
			<dt class="menu-item">
				<a href="spreadsheets/LIBOR%20Market%20Model.zip">LIBOR Market Model.zip</a>
			</dt>
			<dd>
				LIBOR Market Model
				<!--
				(see package <a href="http://www.finmath.net/finmath-lib/apidocs/net.finmath.lib/net/finmath/marketdata/model/curves/package-summary.html"><tt>net.finmath.marketdata.model.curves</tt></a>).
				-->
				<p>
				The sheet allows to create a LIBOR market model calibrated to a given forward curve
				and given swaptions. The parametrized volatility and correlation can be inspected.
				Generated interest rate scenarios can ben extracted.
				</p>

				<b>
				For details see the <a href="/topics/libormarketmodel">LIBOR market model page</a>.
				</b>
			</dd>
		</dl>

		<h3>SABR Model</h3>

		<dl>
			<dt class="menu-item">
				<a href="spreadsheets/SABR%20Model.zip">SABR Model.zip</a>
			</dt>
			<dd>
				SABR Model
				<p>
				A simple sheet to play with SABR parameters and investigate the shape of
				the implied volatility smile, price curve and probability density.
				</p>
			</dd>

			<dt class="menu-item">
				<a href="spreadsheets/SABR%20Model%20Calibration.zip">SABR Model Calibration.zip</a>
			</dt>
			<dd>
				SABR Model Calibration
				<p>
				The sheet demonstrate the calibration of a <i>displaced SABR model</i> to
				a set of implied volatilities for different strikes.
				The sheet allows to set parameters bounds for CEV, displacement, correlation, etc.
				</p>
			</dd>

			<dt class="menu-item">
				<a href="spreadsheets/SABR%20Model%20Interpolation.zip">SABR Model Interpolation.zip</a>
			</dt>
			<dd>
				SABR Model Interpolations
				<p>
				The sheets illustrate the interpolations of SABR smiles via a) naive parameter interpolation and b) skew and curvature interpolation. A naive parameter interpolation results in unplausible smile interpolations.
				</p>
			</dd>
		</dl>

		<a name="requirements"></a>
		<h2>Requirements</h2>
		
		<p>
		For the Excel files (.xls):
		<ul>
			<li>Microsoft Excel for Windows (Windows 7 or better)</li>
			<li>Java 8 Runtime for Windows</li>
			<li><a href="http://www.obba.info">Obba 6.0</a> for Excel</li>
		</ul>
		</p>

		<p>
		For the OpenOffice/LibreOffice files (.odt)
		<ul>
			<li>OpenOffice 3.3 (or LibreOffice, NeoOffice)</li>
			<li>Java 8</li>
			<li><a href="http://www.obba.info">Obba 6.0</a> for OpenOffice</li>
		</ul>
		</p>
		
		<i>Note: Some sheets require a JDK instead of a JRE.</i>

		<h2>Code</h2>
		
		<p>
			The source code behind these sheets can be found in the <tt><a href="/finmath-lib">finmath lib</a></tt> repository.
		</p>
		
		<h2>Disclaimer</h2>

		THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
		INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
		IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY,
		OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
		OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
		(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY
		OF SUCH DAMAGE.
	</body>
</html>
